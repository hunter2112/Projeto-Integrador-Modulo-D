<!DOCTYPE html>
<html lang="pt-BR">
  <head>
  <meta charset="UTF-8">
  <title>Cadastro de Planta - Herbário Digital</title>
  <!-- Faz com que as configurações de estilo sejam "puxadas" do arquivo "styles.css" -->
  <link rel="stylesheet" href="assets/css/base.css" />
  <!-- Link que adiciona um ícone à guia da página -->
  <link
    rel="shortcut icon"
    type="imagex/png"
    href="assets/img/plant_icon.png"
  />
</head>

<body class="cadastro">
  <!--Barra de Navegação centralizada com links direcionais-->
    <nav class="navbar centro">
      <div class="nav-item">
        <a class="navlink" href="base.html"><img class="site_logo" src="assets/img/plant_icon.png" alt="logo"></a>
        <div class="underline"></div>
      </div>
      <div class="nav-item">
        <a class="navlink" href="cadastro.html">Cadastro</a>
        <div class="underline"></div>
      </div>
      <div class="nav-item">
        <a class="navlink" href="">Pesquise pelo nome</a>
        <div class="underline"></div>
      </div>
      <div class="nav-item">
        <a class="navlink" href="">Pesquise pelo uso</a>
        <div class="underline"></div>
      </div>
      <div class="nav-item">
        <a class="navlink" href="catalogo.html">Catálogo</a>
        <div class="underline"></div>
      </div>
    </nav>
  <h1>Cadastro de Planta - Herbário Digital</h1>
  <!-- Formulário com ID "formPlanta" -->
  <!-- enctype="multipart/form-data" é necessário para envio de arquivos -->

  <form id="formPlanta" enctype="multipart/form-data">
    <!-- Nome comum da planta -->
    <label for="nome">Nome comum:</label>
    <input class="texto" type="text" id="nome" name="nome" required> <br>
    <br>
    <!-- Nome científico -->
    <label for="nome_cientifico">Nome científico:</label>
    <input class="texto" type="text" id="nome_cientifico" name="nome_cientifico" required>  <br>
    <br>
    <!-- Descrição da planta -->
    <label for="descricao">Descrição:</label> <br>
    <textarea id="descricao" name="descricao" required></textarea>  <br>
    <br>
    <!-- Características da planta -->
    <label for="caracteristicas">Características:</label> <br>
    <textarea id="caracteristicas" name="caracteristicas" required></textarea>  <br>
    <br>
    <!-- Uso medicinal, ornamental etc. -->
    <label for="uso">Uso:</label> <br>
    <textarea id="uso" name="uso"></textarea>  <br>
    <br>
    <div class="botoes">
    <!-- Upload de imagem da planta -->
    <label for="imagem" class="botao_cadastro">Escolher imagem</label>
    <input type="file" id="imagem" name="imagem" accept="image/*" hidden> 
    <br>
    <br>
    <!-- Botão de envio -->
    <input class="botao_cadastro" type="submit" value="Cadastrar Planta"> <br>
    </div>
    
  </form>

  <!-- Div onde vamos exibir mensagens de sucesso/erro -->
  <div id="mensagem"></div>

  <!-- SCRIPT JAVASCRIPT -->
  
  <script>
  const input = document.getElementById("imagem");
  const fileName = document.getElementById("file-name");

  input.addEventListener("change", () => {
    fileName.textContent = input.files.length > 0 
      ? input.files[0].name 
      : "Nenhum arquivo selecionado";
  });
</script>
  <script>
    // Adiciona um evento ao formulário que será executado no momento do envio
    document.getElementById("formPlanta").addEventListener("submit", function (e) {
      e.preventDefault(); // Impede que a página seja recarregada (comportamento padrão do formulário)

      const form = e.target;               // Pega o formulário enviado
      const formData = new FormData(form); // Cria um objeto FormData com os dados do formulário (inclusive o arquivo)

      // Envia os dados usando fetch para a rota do backend
      fetch("/cadastrar_planta", { // <- Você precisa ter essa rota no backend
        method: "POST",            // Método POST para envio dos dados
        body: formData             // Corpo da requisição com o FormData (texto + imagem)
      })
      .then(response => {
        if (!response.ok) {
          // Se a resposta não for OK, lança um erro
          throw new Error("Erro ao enviar os dados.");
        }
        return response.text(); // Pode usar .json() se o backend retornar JSON
      })
      .then(data => {
        // Se deu tudo certo, exibe mensagem de sucesso
        document.getElementById("mensagem").innerHTML = `<p style="color:green;">Cadastro realizado com sucesso!</p>`;
        form.reset(); // Limpa o formulário
      })
      .catch(error => {
        // Se houve erro, exibe mensagem de erro
        document.getElementById("mensagem").innerHTML = `<p style="color:red;">Erro: ${error.message}</p>`;
      });
    });
  </script>
  <script src="scripts/script.js"></script>
  <!-- Rodapé do site -->
    <footer><p>&copy; 2024 Herbário Digital. Preservando o conhecimento botânico para as futuras gerações.</p></footer>
</body>


</html>